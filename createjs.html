<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>Discord コマンド自動生成ツール</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body { font-family:sans-serif; background:#f5f5f5; padding:20px; }
main { background:#fff; padding:20px; border-radius:10px; max-width:700px; margin:auto; }
label { font-weight:bold; margin-top:10px; display:block; }
select,input[type=text],input[type=number] { width:100%; padding:6px; margin:5px 0; }
button { background:#5865f2; color:white; padding:8px 16px; border:none; border-radius:6px; margin-top:10px; cursor:pointer; }
.output { white-space:pre-wrap; background:#f0f0f0; padding:10px; margin-top:10px; border-radius:6px; min-height:100px; }
.return-link { display:inline-block; margin-top:15px; color:#5865f2; text-decoration:none; font-weight:bold; }
.return-link:hover { text-decoration:underline; }
</style>
</head>
<body>
<main>
  <h1>Discord コマンド自動生成</h1>

  <label>コマンド名</label>
  <input id="commandName" placeholder="例: mute">

  <label>プレフィックス（任意）</label>
  <input id="prefix" placeholder="例: !, /, など">

  <label>ライブラリ</label>
  <select id="framework">
    <option value="discord.js">discord.js (v14)</option>
    <option value="discord.py">discord.py (v2.x)</option>
  </select>

  <label>コマンドタイプ</label>
  <select id="commandType">
    <option value="slash">スラッシュ</option>
    <option value="prefix">プレフィックス</option>
  </select>

  <label>アクション（1つだけ選択）</label>
  <div>
    <label><input type="radio" name="action" value="timeout">タイムアウト</label>
    <label><input type="radio" name="action" value="ban">BAN</label>
    <label><input type="radio" name="action" value="kick">KICK</label>
    <label><input type="radio" name="action" value="send">メッセージ送信</label>
  </div>

  <label><input type="checkbox" id="useEmbed"> Embedを使う</label>
  <div id="embedOptions" style="display:none;">
    <label>Embedタイトル</label>
    <input id="embedTitle" placeholder="例: 実行結果">
    <label>Embed説明</label>
    <input id="embedDesc" placeholder="例: 処理が正常に完了しました。">
    <label>Embedカラー</label>
    <input id="embedColor" placeholder="#5865F2">
  </div>

  <label>理由</label>
  <input id="reason" placeholder="任意">

  <label>タイムアウト秒</label>
  <input type="number" id="timeout" placeholder="例: 600">

  <button onclick="generateCode()">コード生成</button>
  <button onclick="copyCode()">コピー</button>
  <button onclick="downloadCode()">ダウンロード</button>

  <a href="index.html" class="return-link">トップページへ戻る</a>

  <div id="output" class="output"></div>
</main>

<script>
document.getElementById('useEmbed').addEventListener('change', e => {
  document.getElementById('embedOptions').style.display = e.target.checked ? 'block' : 'none';
});

function generateCode() {
  const name = document.getElementById('commandName').value.trim() || 'mycommand';
  const prefix = document.getElementById('prefix').value.trim() || '!';
  const framework = document.getElementById('framework').value;
  const type = document.getElementById('commandType').value;
  const action = document.querySelector('input[name="action"]:checked')?.value;
  const reason = document.getElementById('reason').value.trim() || 'No reason provided';
  const timeoutSec = parseInt(document.getElementById('timeout').value, 10) || 0;
  const timeoutMs = timeoutSec * 1000;

  const useEmbed = document.getElementById('useEmbed').checked;
  const embedTitle = document.getElementById('embedTitle').value.trim() || '結果';
  const embedDesc = document.getElementById('embedDesc').value.trim() || '処理が完了しました。';
  const embedColor = document.getElementById('embedColor').value.trim() || '#5865F2';
  const embedColorHex = embedColor.replace('#','0x');

  if (!action) {
    document.getElementById('output').textContent = 'アクションを1つ選択してください。';
    return;
  }

  let code = '';

  if (framework === 'discord.js') {
    if (type === 'slash') {
      code = `const { SlashCommandBuilder } = require('discord.js');

module.exports = {
  data: new SlashCommandBuilder()
    .setName('${name}')
    .setDescription('Generated command'),
  async execute(interaction) {
    switch('${action}') {
      case 'timeout':
        await interaction.member.timeout(${timeoutMs}, '${reason}');
        ${useEmbed ? `const embed = { title: "${embedTitle}", description: "${embedDesc}", color: ${embedColorHex} };
        await interaction.reply({ embeds: [embed] });` : `await interaction.reply('${embedDesc}');`}
        break;
      case 'ban':
        await interaction.guild.members.ban(interaction.user, { reason: '${reason}' });
        ${useEmbed ? `const embed = { title: "${embedTitle}", description: "${embedDesc}", color: ${embedColorHex} };
        await interaction.reply({ embeds: [embed] });` : `await interaction.reply('${embedDesc}');`}
        break;
      case 'kick':
        await interaction.member.kick('${reason}');
        ${useEmbed ? `const embed = { title: "${embedTitle}", description: "${embedDesc}", color: ${embedColorHex} };
        await interaction.reply({ embeds: [embed] });` : `await interaction.reply('${embedDesc}');`}
        break;
      case 'send':
        ${useEmbed ? `const embed = { title: "${embedTitle}", description: "${embedDesc}", color: ${embedColorHex} };
        await interaction.reply({ embeds: [embed] });` : `await interaction.reply('${embedDesc}');`}
        break;
    }
  }
};`;
    } else {
      code = `client.on('messageCreate', async (message) => {
  if (message.author.bot) return;
  if (message.content.startsWith('${prefix}${name}')) {
    switch('${action}') {
      case 'timeout':
        await message.member.timeout(${timeoutMs}, '${reason}');
        ${useEmbed ? `const embed = { title: "${embedTitle}", description: "${embedDesc}", color: ${embedColorHex} };
        message.channel.send({ embeds: [embed] });` : `message.reply('${embedDesc}');`}
        break;
      case 'ban':
        await message.member.ban({ reason: '${reason}' });
        ${useEmbed ? `const embed = { title: "${embedTitle}", description: "${embedDesc}", color: ${embedColorHex} };
        message.channel.send({ embeds: [embed] });` : `message.reply('${embedDesc}');`}
        break;
      case 'kick':
        await message.member.kick('${reason}');
        ${useEmbed ? `const embed = { title: "${embedTitle}", description: "${embedDesc}", color: ${embedColorHex} };
        message.channel.send({ embeds: [embed] });` : `message.reply('${embedDesc}');`}
        break;
      case 'send':
        ${useEmbed ? `const embed = { title: "${embedTitle}", description: "${embedDesc}", color: ${embedColorHex} };
        message.channel.send({ embeds: [embed] });` : `message.channel.send('${embedDesc}');`}
        break;
    }
  }
});`;
    }
  } else if (framework === 'discord.py') {
    if (type === 'slash') {
      code = `import discord
from discord import app_commands
from discord.ext import commands

class ${name.capitalize()}(commands.Cog):
    def __init__(self, bot: commands.Bot):
        self.bot = bot

    @app_commands.command(name="${name}", description="Generated command")
    async def ${name}(self, interaction: discord.Interaction):
        match '${action}':
            case 'timeout':
                await interaction.user.timeout(discord.utils.utcnow() + discord.timedelta(seconds=${timeoutSec}), reason="${reason}")
                ${useEmbed ? `embed = discord.Embed(title="${embedTitle}", description="${embedDesc}", color=${embedColorHex})
                await interaction.response.send_message(embed=embed)` : `await interaction.response.send_message("${embedDesc}")`}
            case 'ban':
                await interaction.guild.ban(interaction.user, reason="${reason}")
                ${useEmbed ? `embed = discord.Embed(title="${embedTitle}", description="${embedDesc}", color=${embedColorHex})
                await interaction.response.send_message(embed=embed)` : `await interaction.response.send_message("${embedDesc}")`}
            case 'kick':
                await interaction.guild.kick(interaction.user, reason="${reason}")
                ${useEmbed ? `embed = discord.Embed(title="${embedTitle}", description="${embedDesc}", color=${embedColorHex})
                await interaction.response.send_message(embed=embed)` : `await interaction.response.send_message("${embedDesc}")`}
            case 'send':
                ${useEmbed ? `embed = discord.Embed(title="${embedTitle}", description="${embedDesc}", color=${embedColorHex})
                await interaction.response.send_message(embed=embed)` : `await interaction.response.send_message("${embedDesc}")`}

async def setup(bot: commands.Bot):
    await bot.add_cog(${name.capitalize()}(bot))`;
    } else {
      code = `@bot.command()
async def ${name}(ctx):
    match '${action}':
        case 'timeout':
            await ctx.author.timeout(discord.utils.utcnow() + discord.timedelta(seconds=${timeoutSec}), reason="${reason}")
            ${useEmbed ? `embed = discord.Embed(title="${embedTitle}", description="${embedDesc}", color=${embedColorHex})
            await ctx.send(embed=embed)` : `await ctx.send("${embedDesc}")`}
        case 'ban':
            await ctx.guild.ban(ctx.author, reason="${reason}")
            ${useEmbed ? `embed = discord.Embed(title="${embedTitle}", description="${embedDesc}", color=${embedColorHex})
            await ctx.send(embed=embed)` : `await ctx.send("${embedDesc}")`}
        case 'kick':
            await ctx.guild.kick(ctx.author, reason="${reason}")
            ${useEmbed ? `embed = discord.Embed(title="${embedTitle}", description="${embedDesc}", color=${embedColorHex})
            await ctx.send(embed=embed)` : `await ctx.send("${embedDesc}")`}
        case 'send':
            ${useEmbed ? `embed = discord.Embed(title="${embedTitle}", description="${embedDesc}", color=${embedColorHex})
            await ctx.send(embed=embed)` : `await ctx.send("${embedDesc}")`}`;
    }
  }

  document.getElementById('output').textContent = code;
}

function copyCode() {
  const code = document.getElementById('output').textContent;
  navigator.clipboard.writeText(code);
  alert('コピーしました！');
}

function downloadCode() {
  const framework = document.getElementById('framework').value;
  const name = document.getElementById('commandName').value.trim() || 'command';
  const ext = framework === 'discord.py' ? 'py' : 'js';
  const date = new Date().toISOString().split('T')[0];
  const blob = new Blob([document.getElementById('output').textContent], { type: 'text/plain' });
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = `${name}_${date}.${ext}`;
  link.click();
}
</script>
</body>
</html>